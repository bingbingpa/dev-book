# 테스트 주도 개발 시작하기

- *최범균 저 | 가메출판사 *

- TDD 는 테스트를 먼저 작성하고 테스트에 실패하면 테스트를 통과 시킬 만큼 코드를 추가하는 과정을 반복하면서 점진적으로 기능을 완성해 나간다.
- **첫 번째 테스트를 선택할 때에는 가장 쉽거나 가장 예외적인 상황을 선택해야 한다.**
- 정해진 값을 리턴 > 값 비교를 이용해서 정해진 값을 리턴 > 다양한 테스트를 추가하면서 구현을 일반화 이 순서대로 TDD 를 익혀보자.
- 몇 차례 상수를 사용해서 테스트를 통과시키고 뒤에 구현을 일반화하는 과정이 처음에은 지루하게 느껴질 수 있지만, 이런 연습 과정은 점진적인 구현을 진행 할 수 있는 밑거름이 된다.
- 테스트 코드의 구현 중복을 기계적으로 제거하면 자칫 테스트 메서드가 검증하고 싶은 내용을 알아보기 힘들 수 있다.
  - 일단 중복 제거를 해보고 테스트 코드가 여전히 자신을 잘 설명하고 있는지 확인해보자.
- TDD 를 시작할 때 테스트할 목록을 미리 정리하면 좋다. 
  - 이렇게 테스트할 내용을 정리했다면 이 중에 어떤 테스트가 구현이 쉬울지 상상해본다. 또는 어떤 테스트가 예외적인지 상상해본다.
- 테스트 코드 작성이 어렵다면 검증하는 코드부터 작성하기 시작하면 도움이 된다.
- TDD 는 테스트를 통과할 만큼만 코드를 작성한다. 필요할 것으로 예측해서 미리 코드를 만들지 않는다.
  - 필요할 것으로 예측해서 미리 설계를 유연하게 만들지 않는다.
  - 실제 테스트 사례를 추가하고 통과시키는 과정에서 필요한 만큼 설계를 변경한다.
- 테스트 코드를 작성하기 위해 개발자는 기능 명세를 정리해야 한다.
- 개발자는 요구사항 문서에서 기능의 입력과 출력을 도출해야 한다.
- 모호한 상황을 만나면 이를 구체적인 예로 바꾸어 테스트 코드에 반영한다. 즉 테스트 코드는 예를 이용한 구체적인 명세가 된다.
- test double 은 테스트에서 진짜 대신 사용할 대역을 의미한다.
- 대역의 종류
  - 스텁(Stub): 구현을 단순한 것으로 대체한다. 테스트에 맞게 단순히 원하는 동작을 수행한다.
  - 가짜(Fake): 제품에는 적합하지 않지만, 실제 동작하는 구현을 제공한다. DB 대신에 메모리를 이용한 repository 가 가짜 대역에 해당한다.
  - 스파이(Spy): 호출된 내역을 기록한다. 기록한 내용은 테스트 결과를 검증할 때 사용한다.
  - 모의(Mock): 기대한 대로 상호작용하는지 행위를 검증한다.
- repository 같이 저장소에 대한 대역은 모의 객체를 사용하는 것보다 메모리를 이용한 가짜 구현을 사용하는 것이 테스트 코드 관리에 유리하다.
- 모의 객체의 메서드 호출 여부를 결과 검증 수단으로 사용하는 것은 주의해야 한다.