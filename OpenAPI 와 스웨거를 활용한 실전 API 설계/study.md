# 1주차 1장 ~ 5장(2024.05.21)

## API 설계의 특수성

1. API 는 다른 서비스를 개발하기 위한 중간 제품
2. API 변화는 그 API 를 사용한 모든 서비스에 문제를 발생시킴

### API 설계 원칙

- 협업 - 참여한 이해관계자들의 충분한 합의(다수가 동의한 것)
- 성과 - 가치, 도메인을 중심에 둘 것(쓸모있는 것)
- 기술 - 기술 선택은 용도에 맞출 것(기술 중심이 아닐 것)
- 약속 - API 는 고객과의 약속. 큰 책임을 고려할 것(신중히 설계)
- **문서 - 무엇보다 문서가 우선될 것**

### 문서 작성 흐름

- 개발 중심 흐름

1. 개발부터하고 그 결과를 문서로 생성함
2. 개발이 변경되면 자동 생성기가 문서를 변화시킴
3. springDoc 을 비롯한 많은 자동 문서 생성기를 이용함

- API 설계 원칙 흐름

1. 5대 원칙에 근거하여 API 문서가 먼저 작성됨
2. 도메인이나 고객의 변화에 따라 API 의 변화가 생겨남
3. 실제 개발되는 코드나 언어와 무관하게 문서가 운영됨

### 문서 작성 기본 요령

- ADDR 프로세스에 따라
    - Align: 관련된 모든 것을 일정하게 나열해 정리하는 것
        - 마구 가져온 걸 분류하고 정리
        - 119 긴급출동에 대한 모든 도메인을 다 가져와봐
    - Define: 정리된 사실, 목표로부터 뭘 만들지 정의하는 것
    - Design: 정의된 것을 실체화하는 설계(디자인)
        - 아키텍처는 큰거, 디자인은 작은거. API 하나 정도는 디자인
        - 건축에서는 집 한체 아키텍처. 인테리어 디자인이라 하는데 아키텍처가 맞지 않나? 분류하기 어려움. 한국어로는 설계 하나 뿐임.
    - Refine: 만들어진 제품을 다듬고 검수하는 것

1. 도메인분석을 통한 작업스토리(유저의 욕망?!) 추출 및 디지털기능식별
2. 작업스토리별 액티비티단계 캡쳐
3. 이벤트스토밍의 네러티브를 이용한 API 경계식별(애그리거트분리)
4. 식별된 바운디드컨텍스트 내의 구체적인 개별 API 정의
5. REST 구조에 맞는 실제 설계


1. DDD 의 여러 기법 동원
2. 유저스토리매핑, 작업스토리, 스토리스토밍, 유즈케이스, 예제매핑 등
    - 이벤트 스토밍 - 유저 네러티브를 중심으로 찾아낸다. 내러티브에 특화되어 있다. 너무 많은 내러티브를 가져오면 어렵다. 사회자가 주요 내러티브를 잘 정하느냐에 따라 성공 유무가 갈린다. 도메인 전문가가
      있을 때 유리하다
    - 도메인 스토리텔링 - 참가자 간의 협력구조를 중심으로 도메인 탐색. 전체 도메인을 꿰뚫고 있는 전문가가 없어도 찾아나가는 과정을 겪는다
    - 유저 스토리 매핑 - 사용자 간 큰 활동의 흐름을 찾고 하위 단계 탐색. 시작은 유저에서 시작해서 유저의 중심 활동에서 하위 활동들을 찾아내고 어떠한 순서대로 하는지 기술함
    - 예제 매핑 - 구체적인 사례를 전개해가면서 하위 단계 탐색. 퍼소나 분석이랑 비슷함
    - 스토리 스토밍 - 사용자 간 상호작용과 그 산출물 분석
    - 유즈 케이스 - 다양한 내부 모델링 툴을 이용해 다각도로 도메인을 분석
3. 실제 도메인을 파악하고 시장성 있는 기능이 무엇인지 분석하는 과정

### 요청의 개념

1. 요청은 사용자의 니즈를 나타냄
2. 사용자의 니즈는 사용자가 받고 싶은 혜택을 표현함
3. 니즈와 혜택을 일치시키는 과정이 요청의 정의임

- 요청의 특성

1. 사용자가 얻게될 혜택을 추상화하여 포괄적으로 정의할수록 요청 시의 변수가 많아짐
2. 예를 들어 "우리회사 남자대리의 이름을 알고 싶다"로 혜택의 범위를 줄이면 요청시 아무런 변수도 필요없음
3. 헌데 "어떤 회사의 어떤 기간동안 재직한 직원들의 직급과 이름을 알고 싶다"로 혜택을 늘리면 많은 요청 변수가 생겨남
4. 문제는 2번과 3번이 같은 종류의 혜택인가를 **결정**해야함
    - 서비스의 전략을 결정해야 한다.

### 요청, 응답의 정의

- 요청 정의 시 유의점

1. 메소드 적용을 엄격하게 할 것인가
2. 멱등성의 범위를 어떻게 정의할 것인가
3. 요청 변수는 공통 포멧을 적용할 것인가
4. 인증, 인가, 상태를 어떻게 처리할 것인가

- 응답 정의 시 유의점

1. 모든 응답의 공통 포맷을 적용할 것인가
2. 응답의 상태별 공통 포맷을 적용할 것인가
3. 정상응답의 페이로드는 공통 포맷을 적용할 것인가
4. 응답코드의 공통 기준을 적용할 것인가
5. 하이퍼미디어를 적용할 것인가

다음주는 10장까지