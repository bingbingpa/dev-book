# 만들면서 배우는 클린 아키텍처
- *톰 홈버그 저/박소은 역 | 위키북스*

## 01 계층형 아키텍처의 문제는 무엇일까?

- 전통적인 계층형 구조의 웹 애플리케이션 구조
  - 맨 위의 **웹**계층에서는 요청을 받아 **도메인** 혹은 비즈니스 계층에 있는 서비스로 요청을 보낸다.
  - 서비스에서는 필요한 비즈니스 로직을 수행한다.
  - 비즈니스 로직을 수행하고, 도메인 엔티티의 현재 상태를 조회하거나 변경하기 위해 **영속성** 계층의 컴포넌트를 호출한다. 
- 계층형 아키텍처는 데이터베이스 주도 설계를 유도한다.
  - 웹 계층은 도메인 계층에 의존하고, 도메인 계층은 영속성 계층에 의존하기 때문에 자연스레 데이터베이스에 의존하게 된다.
  - **다른 무엇보다도 도메인 로직을 먼저 만들어야 한다. 그래야만 우리가 로직을 제대로 이해 했는지 확인할 수 있다.**
    - 그리고 도메인 로직이 맞다는 것을 확인한 후에 이를 기반으로 영속성 계층과 웹 계층을 만들어야 한다.
  - 데이터베이스 중심적인 아키텍처가 만들어지는 가장 큰 원인은 ORM(object-relational-mapping, 객체 관계 매핑) 프레임워크를 사용하기 때문이다.
    - ORM 에 의해 관리되는 엔티티들은 일반적으로 영속성 계층에 둔다. 하지만 이렇게 되면 영속성 계층과 도메인 계층 사이에 강한 결합이 생긴다.
    - 서비스는 영속성 모델을 비즈니스 모델처럼 사용하게 되고 이로 인해 도메인 로직뿐만 아니라 즉시로딩/지연로딩, 데이터베이스 트랜잭션, 캐시 플러시 등등 영속성 계층과 관련된 작업들을 해야만 한다.
- 지름길을 택하기 쉬워진다.
