# 켄트 벡의 Tidy First

- *켄트 벡 저/안영회 역 | 한빛미디어*

- 소프트웨어 설계를 정말 잘하고 싶다면 하루에 여러 번 설계 고민을 하고 실천을 해 봐야 한다.

### PART 01 코드 정리법

- 중첩된 조건은 헷갈린다. early return 을 활용해서 코드를 정리하자. ([예시](https://github.com/Bogdanp/dramatiq/pull/470/files))
- 안 쓰는 코드(실행되지 않는 코드)는 형상 관리 도구를 믿고 지워 버리자.
- 읽는 입장에서는 일관성이 중요하다. 한 가지 방식을 선택해서 정하고, 다른 방식으로 작성한 코드를 선택한 방식으로 고치자.
- 읽기 좋은 순서로 정리하자.
- 변경할 요소들을 가까이 둬서 응집도를 높이자. 시간적 여유가 있다면 결합도는 제거하자.
- 변수를 사용하기 직전에 선언하고 초기화 하자
   - 작은 단계로 작업하라. 커다란 설계 변경은 어렵고 무섭다면? 더 작은 단계로 진행하자.
- 코드 정리에 대한 커밋과 동작 변경에 대한 커밋은 분리해야한다.
- 상징적인 상수를 만들자. 리터럴 상수로 사용된 곳은 상징적인 상수로 바꾼다.
- 관련 있는 코드를 뭉쳐두자.
- 필요한 만큼의 코드를 하나의 더미처럼 느껴질 때까지 흩어진 코드를 모으자. 그러고 나서 깔끔하게 정리하자.
  - 코드를 한데 모아서 이해하기 어려운 부분은 추출해서 새롭게 정리해야 한다.
- 코드만으로 내용을 모두 이해할 수 있다면 주석은 삭제하자. 하지만 그게 아니라면 주석을 남기자.
- 코드 정리는 리팩터링으로 가는 관문이다.

### PART 02 관리

- 코드 정리는 별도의 PR 로 만들고, 가급적 PR 당 몇 개의 코드 정리만 넣는다.
- 코드를 계속 정리하고 싶은 충동을 관리하는 것도 코드 정리의 핵심 기술이다.
- 코드 구조를 대대적으로 바꾸려고 코드 정리를 시작하는 경우가 많다. 너무 많이, 너무 빠르게 변경하지 않도록 주의하자.
- 한 번의 코드 정리에 한 시간 이상이 걸린다면, 이는 원하는 동작 변경을 위해 필요한 최소한의 구조 변경 시기를 놓쳤다는 의미일 수 있다.
- 다음의 경우라면 동작 변경 후 코드를 정리한다.
  - 방금 고친 코드를 다시 변경할 예정일 때
  - 지금 정리하는 것이 더 저렴할 때
  - 코드 정리하는 데 드는 시간이 동작 변경에 드는 시간과 거의 비슷할 때
- 정리를 먼저 하는 경우
  - 지저분한 상태 그대로 코드를 변경한다면, 일이 얼마나 더 어려운가? 코드를 정리한다고 해서 더 쉬워지지 않는다면, 먼저 정리하자.
  - 코드를 정리한다면, 더 빨리 이해할 수 있겠다고 판단이 되는 경우 


### PART 03 이론

- 소프트웨어 설계는 인관관계 속에서 벌어지는 활동이며, 요소들을 유익하게 관계 맺는 일이다.
- 하나의 설계 작업은 작은 하위 요소로 만든 거대한 수프를 만드는 일과 같다.
- 소프트웨어는 두 가지 방식으로 가치를 만든다.
  - 현재 소프트웨어가 하는 일
  - 미래에 새로운 일을 시킬 수 있는 가능성
- 소프트웨어 설계는 '먼저 벌고 나중에 써야 한다'와 '물건이 아닌 옵션을 만들어야 한다'는 두 가지 속성을 조화시켜야 한다.
- 오늘 우리가 하는 설계는 내일의 동작 변경을 '구매'하는 '옵션'에 대해 지불하는 프리미엄이다.
